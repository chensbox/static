import{I as P}from"./index.e6169b20.js";import{r as C,o as S,a as b,d as i,j as O,v as j,n as f,i as c,t as m,f as p,e as z,h as A,g as E,G as H,B as v,O as h}from"./vue-libs.361a333e.js";import{s as I}from"./sleep.2dba75b7.js";import{_ as M}from"./iframe-router.446ee3db.js";function R(e){return(t,s)=>(t&&typeof t!="string"&&(s=t,t=""),t=t?`${e}__${t}`:e,`${t}${y(t,s)}`)}function y(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((s,n)=>s+y(e,n),""):Object.keys(t).reduce((s,n)=>s+(t[n]?y(e,n):""),""):""}function G(e){const t=`t-${e}`;return[t,R(t)]}const N=[Number,String],g=e=>({type:N,default:e}),T=e=>({type:String,default:e});const[q,F]=G("pull-refresh"),J=["refresh","update:modelValue"],K={modelValue:Boolean,pullingText:T("\u4E0B\u62C9\u5373\u53EF\u5237\u65B0..."),loosingText:T("\u91CA\u653E\u5373\u53EF\u5237\u65B0..."),loadingText:T("\u52A0\u8F7D\u4E2D..."),successDuration:g(.5),animationDuration:g(.2),headHeight:g(50),pullDistance:N,successText:String},L={Icon:P};function Q(e,{emit:t}){var k;const s=v(0),n=v(),u=v(!1),o=(k=e.pullDistance)!=null?k:e.headHeight,d=h(()=>({transform:`translateY(${s.value}px)`,transition:`all ${n.value}s`})),r=h(()=>s.value<o?e.pullingText:e.loosingText),B=h(()=>s.value>o?o:s.value);let $,D;const Y=l=>$=l.touches[0].pageY,V=async()=>{t("update:modelValue",!1),e.successText&&s.value>=o&&(u.value=!0,await I(e.successDuration*1e3)),s.value=0,u.value=!1};return{bem:F,isDone:u,offsetY:s,touchend:()=>{if(n.value=e.animationDuration,s.value<o)return V();s.value=o,t("update:modelValue",!0),t("refresh",V)},touchmove:l=>{const w=!(document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset);D=l.touches[0].pageY;let a=D-$;a<0&&s.value<=0||(a>0&&w&&l.preventDefault(),a>o&&(a<o*2?a=o+(a-o)/2:a=o*1.5+(a-o*2)/4),n.value=0,s.value=Math.round(a))},touchstart:Y,trackStyle:d,statusText:r,slotDistance:B}}const U={name:q,components:L,props:K,emits:J,setup:Q},W={key:0};function X(e,t,s,n,u,o){const d=C("icon");return S(),b("div",{class:f(e.bem({"disable-touch":e.modelValue})),onTouchstart:t[0]||(t[0]=(...r)=>e.touchstart&&e.touchstart(...r)),onTouchmove:t[1]||(t[1]=H((...r)=>e.touchmove&&e.touchmove(...r),["stop"])),onTouchend:t[2]||(t[2]=(...r)=>e.touchend&&e.touchend(...r))},[i("div",{class:f(e.bem("track")),style:E(e.trackStyle)},[O(i("div",{class:f(e.bem("header"))},[!e.modelValue&&!e.isDone?c(e.$slots,"pulling",{key:0,distance:e.slotDistance},()=>[i("span",null,m(e.statusText),1)]):p("v-if",!0),c(e.$slots,"success",{},()=>[e.successText&&e.isDone?(S(),b("span",W,m(e.successText),1)):p("v-if",!0)]),e.modelValue?c(e.$slots,"loading",{key:1},()=>[i("span",null,[z(d,{name:"loading"}),A(" "+m(e.loadingText),1)])]):p("v-if",!0)],2),[[j,e.slotDistance]]),c(e.$slots,"default")],6)],34)}var oe=M(U,[["render",X]]);export{oe as P,g as a,G as c,T as m};
