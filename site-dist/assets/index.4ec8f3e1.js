import{I as N}from"./index.e25eee73.js";import{r as B,o as $,a as S,d as i,j as P,v as C,n as d,i as c,t as f,f as p,e as z,h as E,g as H,G as I,B as v,L as h}from"./vue-libs.ecaed212.js";import{s as M}from"./sleep.2dba75b7.js";import{c as R}from"./createBem.9e81425a.js";import{m as g,b as T,n as j}from"./props.4d0560a6.js";import{_ as G}from"./iframe-router.1a75ae54.js";const[L,O]=R("pull-refresh"),q=["refresh","update:modelValue"],A={modelValue:Boolean,pullingText:g("\u4E0B\u62C9\u5373\u53EF\u5237\u65B0..."),loosingText:g("\u91CA\u653E\u5373\u53EF\u5237\u65B0..."),loadingText:g("\u52A0\u8F7D\u4E2D..."),successDuration:T(.5),animationDuration:T(.2),headHeight:T(50),pullDistance:j,successText:String},F={Icon:N};function J(e,{emit:t}){var k;const o=v(0),l=v(),u=v(!1),s=(k=e.pullDistance)!=null?k:e.headHeight,m=h(()=>({transform:`translateY(${o.value}px)`,transition:`all ${l.value}s`})),n=h(()=>o.value<s?e.pullingText:e.loosingText),b=h(()=>o.value>s?s:o.value);let D,y;const Y=r=>D=r.touches[0].pageY,V=async()=>{t("update:modelValue",!1),e.successText&&o.value>=s&&(u.value=!0,await M(e.successDuration*1e3)),o.value=0,u.value=!1};return{bem:O,isDone:u,offsetY:o,touchend:()=>{if(l.value=e.animationDuration,o.value<s)return V();o.value=s,t("update:modelValue",!0),t("refresh",V)},touchmove:r=>{const w=!(document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset);y=r.touches[0].pageY;let a=y-D;a<0&&o.value<=0||(a>0&&w&&r.preventDefault(),a>s&&(a<s*2?a=s+(a-s)/2:a=s*1.5+(a-s*2)/4),l.value=0,o.value=Math.round(a))},touchstart:Y,trackStyle:m,statusText:n,slotDistance:b}}const K={name:L,components:F,props:A,emits:q,setup:J},Q={key:0};function U(e,t,o,l,u,s){const m=B("icon");return $(),S("div",{class:d(e.bem({"disable-touch":e.modelValue})),onTouchstart:t[0]||(t[0]=(...n)=>e.touchstart&&e.touchstart(...n)),onTouchmove:t[1]||(t[1]=I((...n)=>e.touchmove&&e.touchmove(...n),["stop"])),onTouchend:t[2]||(t[2]=(...n)=>e.touchend&&e.touchend(...n))},[i("div",{class:d(e.bem("track")),style:H(e.trackStyle)},[P(i("div",{class:d(e.bem("header"))},[!e.modelValue&&!e.isDone?c(e.$slots,"pulling",{key:0,distance:e.slotDistance},()=>[i("span",null,f(e.statusText),1)]):p("v-if",!0),c(e.$slots,"success",{},()=>[e.successText&&e.isDone?($(),S("span",Q,f(e.successText),1)):p("v-if",!0)]),e.modelValue?c(e.$slots,"loading",{key:1},()=>[i("span",null,[z(m,{name:"loading"}),E(" "+f(e.loadingText),1)])]):p("v-if",!0)],2),[[C,e.slotDistance]]),c(e.$slots,"default")],6)],34)}var te=G(K,[["render",U]]);export{te as P};
