import{r as H,o as W,a as E,d as y,G as C,n as w,e as o,w as c,B as p,D as M,q as U,h as N,F as q}from"./vue-libs.42034ed0.js";import{c as R}from"./index.a62ce549.js";import{c as P}from"./index.6b3cb4ae.js";import{p as Y}from"./index.48c4869f.js";import{B as A}from"./index.5597d69e.js";import{c as F}from"./createBem.9e81425a.js";import{b as $,m as B}from"./props.4d0560a6.js";import{_ as O}from"./iframe-router.f13c50c0.js";import{p as X}from"./index.c08dbce9.js";import"./index.0475622b.js";import"./index.eeb025c1.js";/* empty css                                                          *//* empty css                                                           */import"./index.8592a9a9.js";/* empty css                                              */import"./sleep.2dba75b7.js";const[D,G]=F("signature"),z=["save","reset"],J={TButton:A},j={fullscreen:Boolean,width:$(document.body.clientWidth-2),height:$(300),lineWidth:$(2),color:B("black"),filename:B("signatrue"),imgType:B("png")};function K(e,{emit:s}){let d=!1,i=p(),u=p(),v=p(),n,t,T,h;const g=(a,b)=>{d&&(t.beginPath(),t.lineWidth=e.lineWidth,t.strokeStyle=e.color,t.lineCap="round",t.lineJoin="round",t.moveTo(T,h),t.lineTo(a,b),t.stroke(),t.closePath()),T=a,h=b},_=a=>{document.body.classList.add("dis-scroll"),g(a.touches[0].pageX-n.offsetLeft,a.touches[0].pageY-n.offsetTop),d=!0},r=a=>{d&&g(a.touches[0].pageX-n.offsetLeft,a.touches[0].pageY-n.offsetTop)},l=a=>{d=!1,e.fullscreen||document.body.classList.remove("dis-scroll")};function m(){t.beginPath(),t.clearRect(0,0,n.width,n.height),t.closePath(),s("reset")}function f(){const a=n.toDataURL(`image/${e.imgType}`);let b=a.split(","),I=b[0].match(/:(.*?);/)[1],S=window.atob(b[1]),k=S.length,V=new Uint8Array(k);for(;k--;)V[k]=S.charCodeAt(k);e.fullscreen&&document.body.classList.remove("dis-scroll"),s("save",{url:a,file:new File([V],e.filename,{type:I})})}return M(()=>{n=i.value,t=i.value.getContext("2d"),e.fullscreen&&U(()=>{v.value=document.body.clientHeight-u.value.clientHeight-2})}),{bem:G,reset:m,saveImg:f,touchend:l,touchmove:r,canvasRef:i,touchstart:_,controlBarRef:u,fullscreenHeight:v}}const Q={name:D,emits:z,components:J,props:j,setup:K},Z=["width","height"],x=N("\u91CD\u7F6E"),ee=N("\u786E\u5B9A");function te(e,s,d,i,u,v){const n=H("t-button");return W(),E("div",{class:w(e.bem())},[y("div",{class:w(e.bem("canvas"))},[y("canvas",{ref:"canvasRef",width:e.width,height:e.fullscreenHeight||e.height,onTouchstart:s[0]||(s[0]=C((...t)=>e.touchstart&&e.touchstart(...t),["prevent"])),onTouchmove:s[1]||(s[1]=C((...t)=>e.touchmove&&e.touchmove(...t),["prevent"])),onTouchend:s[2]||(s[2]=C((...t)=>e.touchend&&e.touchend(...t),["prevent"]))},null,40,Z)],2),y("div",{class:w(e.bem("control-bar")),ref:"controlBarRef"},[o(n,{class:w(e.bem("button")),type:"wanner",round:"",onClick:e.reset},{default:c(()=>[x]),_:1},8,["class","onClick"]),o(n,{class:w(e.bem("button")),round:"",onClick:e.saveImg},{default:c(()=>[ee]),_:1},8,["class","onClick"])],2)],2)}var L=O(Q,[["render",te]]);const oe=y("div",{class:"img-wrap"},[y("img",{id:"img"})],-1),we={setup(e){const s=p(5),d=p("black"),i=p(!1),u=p(!1),v=p(document.body.clientHeight-62);let n;const t=[{values:["2","4","6","8","10"],defaultIndex:2},{values:["red","blue","black"],defaultIndex:1}],T=r=>{s.value=r[0],d.value=r[1]};function h(r){console.log(r);const l=document.querySelector(".img-wrap"),m=document.createElement("img");m.setAttribute("src",r.url),l.appendChild(m)}function g(){const r=document.querySelector(".img-wrap");r.innerHTML=""}function _(){u.value=!u.value,u.value?(n=document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset,window.pageYOffset=document.body.scrollTop=document.documentElement.scrollTop=0,document.body.classList.add("dis-scroll")):(window.pageYOffset=document.body.scrollTop=document.documentElement.scrollTop=n,document.body.classList.remove("dis-scroll"))}return(r,l)=>{const m=H("demo-block");return W(),E(q,null,[o(m,{title:"\u57FA\u7840\u7528\u6CD5"},{default:c(()=>[o(L,{onSave:h,onReset:g}),oe]),_:1}),o(m,{title:"\u914D\u5408popup\u4F7F\u7528"},{default:c(()=>[o(R,null,{default:c(()=>[o(P,{title:"\u5F39\u51FAsignatrue",onClick:_})]),_:1}),o(Y,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=f=>u.value=f),position:"left"},{default:c(()=>[o(L,{height:v.value,onSave:_,fullscreen:""},null,8,["height"])]),_:1},8,["modelValue"])]),_:1}),o(m,{title:"\u81EA\u5B9A\u4E49\u7EBF\u5BBD\u548C\u989C\u8272"},{default:c(()=>[o(R,null,{default:c(()=>[o(P,{title:"\u81EA\u5B9A\u4E49\u7B14\u8FF9",onClick:l[1]||(l[1]=f=>i.value=!0)})]),_:1}),o(L,{"line-width":s.value,color:d.value,onSave:h,onReset:g},null,8,["line-width","color"]),o(Y,{modelValue:i.value,"onUpdate:modelValue":l[4]||(l[4]=f=>i.value=f),position:"bottom"},{default:c(()=>[o(X,{colums:t,title:"\u8BBE\u7F6E\u7EBF\u5BBD\u548C\u989C\u8272",onChange:T,onCancel:l[2]||(l[2]=f=>i.value=!1),onConfirm:l[3]||(l[3]=f=>i.value=!1)})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{we as default};
